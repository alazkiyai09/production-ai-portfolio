# ========================================
# StreamProcess-Pipeline Configuration
# ========================================

# Application
APP_NAME=streamprocess-pipeline
APP_VERSION=1.0.0
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO

# API Server
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_RELOAD=true

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Kafka Configuration (Alternative to Redis Streams)
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_CONSUMER_GROUP=stream-process-consumers
KAFKA_TOPIC_RAW=adtech.raw.events
KAFKA_TOPIC_PROCESSED=adtech.processed.events
KAFKA_AUTO_OFFSET_RESET=latest
KAFKA_ENABLE_AUTO_COMMIT=true

# PostgreSQL Configuration
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=streamprocess
POSTGRES_USER=streamprocess_user
POSTGRES_PASSWORD=streamprocess_pass
POSTGRES_URL=postgresql://streamprocess_user:streamprocess_pass@localhost:5432/streamprocess
POSTGRES_POOL_SIZE=20
POSTGRES_MAX_OVERFLOW=10
POSTGRES_POOL_TIMEOUT=30
POSTGRES_POOL_RECYCLE=3600

# SQLAlchemy Configuration
SQLALCHEMY_ECHO=false
SQLALCHEMY_POOL_PRE_PING=true
SQLALCHEMY_POOL_RECYCLE=3600

# Celery Configuration
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=3600
CELERY_TASK_SOFT_TIME_LIMIT=3000
CELERY_WORKER_PREFETCH_MULTIPLIER=4
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000
CELERY_WORKER_CONCURRENCY=4

# Flower (Celery Monitor)
FLOWER_PORT=5555
FLOWER_BASIC_AUTH=admin:admin123

# ChromaDB Configuration
CHROMA_HOST=localhost
CHROMA_PORT=8001
CHROMA_PERSIST_DIRECTORY=./data/chroma
CHROMA_COLLECTION_NAME=adtech_embeddings
CHROMA_DISTANCE_FUNCTION=cosine

# Qdrant Configuration (Alternative Vector DB)
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_COLLECTION_NAME=adtech_embeddings
QDRANT_VECTOR_SIZE=384
QDRANT_DISTANCE=Cosine

# Embedding Model Configuration
EMBEDDING_MODEL_NAME=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_MODEL_DEVICE=cpu
EMBEDDING_BATCH_SIZE=32
EMBEDDING_DIMENSION=384
EMBEDDING_CACHE_DIR=./cache/embeddings
EMBEDDING_MAX_LENGTH=512

# Pipeline Configuration
PIPELINE_BATCH_SIZE=100
PIPELINE_BATCH_TIMEOUT=5.0
PIPELINE_MAX_QUEUE_SIZE=10000
PIPELINE_PROCESSING_INTERVAL=1.0
PIPELINE_CHECKPOINT_INTERVAL=100

# Ingestion Configuration
INGESTION_MAX_PAYLOAD_SIZE=10485760
INGESTION_RATE_LIMIT=10000
INGESTION_VALIDATE_SCHEMA=true
INGESTION_DEAD_LETTER_TOPIC=adtech.dead.letter

# Processing Configuration
PROCESSING_WORKERS=4
PROCESSING_QUEUE_SIZE=1000
PROCESSING_RETRY_ATTEMPTS=3
PROCESSING_RETRY_DELAY=1.0
PROCESSING_TIMEOUT=300

# Metrics and Monitoring
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics
PROMETHEUS_MULTIPROC_DIR=./tmp/prometheus

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=streamprocess-pipeline
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=1.0

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# CORS Configuration
CORS_ORIGINS=["http://localhost:3000","http://localhost:8000"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["*"]
CORS_ALLOW_HEADERS=["*"]

# Security
SECRET_KEY=your-secret-key-here-change-in-production
API_KEY_HEADER=X-API-Key
API_KEY_WHITELIST=["dev-key-1","dev-key-2"]

# Testing
TEST_DATABASE_URL=postgresql://streamprocess_user:streamprocess_pass@localhost:5432/streamprocess_test
TEST_REDIS_URL=redis://localhost:6379/15
