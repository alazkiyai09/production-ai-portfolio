---
# Secret for StreamProcess-Pipeline
# IMPORTANT: In production, use sealed-secrets, external-secrets, or vault
# This is a template - replace all values before deploying to production
apiVersion: v1
kind: Secret
metadata:
  name: streamprocess-secret
  namespace: streamprocess
type: Opaque
stringData:
  # PostgreSQL Credentials
  # Generate strong passwords using: openssl rand -base64 32
  POSTGRES_USER: "streamprocess_user"
  POSTGRES_PASSWORD: "CHANGE_THIS_PASSWORD_IN_PRODUCTION"
  POSTGRES_URL: "postgresql://streamprocess_user:CHANGE_THIS_PASSWORD_IN_PRODUCTION@postgres-service:5432/streamprocess"

  # Redis Password (optional, if using Redis AUTH)
  REDIS_PASSWORD: ""

  # Application Secret Key (for signing tokens, etc.)
  # Generate using: openssl rand -hex 32
  SECRET_KEY: "CHANGE_THIS_SECRET_KEY_IN_PRODUCTION_USE_32_BYTES_HEX"

  # API Key Whitelist (comma-separated list of valid API keys)
  API_KEY_WHITELIST: "prod-key-1,prod-key-2,prod-key-3"

  # Celery Flower Authentication
  # Format: username:password
  FLOWER_BASIC_AUTH: "admin:CHANGE_THIS_FLOWER_PASSWORD"

  # OpenAI API Key (if using OpenAI models)
  # OPENAI_API_KEY: "sk-..."

  # HuggingFace Token (if using private models)
  # HUGGINGFACE_TOKEN: "hf_..."

  # External Service Credentials (if applicable)
  # EXTERNAL_API_KEY: "your-external-api-key"

---
# Alternative: SealedSecret (requires sealed-secrets controller)
# Comment out the above Secret and use this in production
# apiVersion: bitnami.com/v1alpha1
# kind: SealedSecret
# metadata:
#   name: streamprocess-secret
#   namespace: streamprocess
# spec:
#   encryptedData:
#     # Use: kubeseal -f 02-secret.yaml -w 02-sealed-secret.yaml
#     POSTGRES_PASSWORD: AgBy3i4OJSWK+PiTySY...
#     SECRET_KEY: AgBy3i4OJSWK+PiTySY...

---
# Alternative: ExternalSecret (requires external-secrets operator)
# Comment out above and use this to sync from external secret manager
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: streamprocess-secret
#   namespace: streamprocess
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     name: aws-secretsmanager
#     kind: SecretStore
#   target:
#     name: streamprocess-secret
#     creationPolicy: Owner
#   data:
#     - secretKey: POSTGRES_PASSWORD
#       remoteRef:
#         key: streamprocess/postgres-password
#     - secretKey: SECRET_KEY
#       remoteRef:
#         key: streamprocess/secret-key
